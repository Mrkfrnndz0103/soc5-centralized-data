"use strict";(()=>{var e={};e.id=6015,e.ids=[6015],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},92761:e=>{e.exports=require("node:async_hooks")},86802:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{originalPathname:()=>_,patchFetch:()=>p,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var a=r(49303),n=r(88716),i=r(60670),o=r(25780),u=e([o]);o=(u.then?(await u)():u)[0];let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/dispatch/submit/route",pathname:"/api/dispatch/submit",filename:"route",bundlePath:"app/api/dispatch/submit/route"},resolvedPagePath:"C:\\Users\\phlspxuser\\Documents\\Mrkcde\\Ongoing\\soc5-internalTool\\src\\app\\api\\dispatch\\submit\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m}=c,_="/api/dispatch/submit/route";function p(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}s()}catch(e){s(e)}})},25780:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{POST:()=>c});var a=r(87070),n=r(75748),i=r(95456),o=r(69026),u=e([n,i]);function p(e,t){for(let r of t)if(void 0!==e[r]&&null!==e[r]&&""!==e[r])return e[r];return null}[n,i]=u.then?(await u)():u;let c=(0,o.g)("/api/dispatch/submit",async e=>{if(!await (0,i.Gg)())return a.NextResponse.json({error:"Unauthorized"},{status:401});let t=await e.json().catch(()=>({})),r=Array.isArray(t?.rows)?t.rows:[],s=t?.submitted_by_ops_id;if(!s)return a.NextResponse.json({error:"submitted_by_ops_id is required"},{status:400});if(0===r.length)return a.NextResponse.json({error:"rows are required"},{status:400});for(let e of r){let t=p(e,["cluster_name","clusterName"]),r=p(e,["station_name","station"]),a=p(e,["region"]),i=p(e,["status"])||"Pending",o=p(e,["lh_trip_number","lh_trip","lHTripNumber"]),u=p(e,["actual_docked_time","actualDockedTime"]),c=p(e,["actual_depart_time","actualDepartTime"]),d=p(e,["processor_name","processorName"]),l=p(e,["plate_number","plateNumber"]);await (0,n.I)(`INSERT INTO dispatch_reports
       (cluster_name, station_name, region, status, lh_trip_number, actual_docked_time, actual_depart_time, processor_name, plate_number, submitted_by_ops_id, created_at, status_updated_at)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, NOW(), NOW())`,[t,r,a,i,o,u?new Date(u):null,c?new Date(c):null,d,l,s])}return a.NextResponse.json({created_count:r.length})});s()}catch(e){s(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,5456],()=>r(86802));module.exports=s})();